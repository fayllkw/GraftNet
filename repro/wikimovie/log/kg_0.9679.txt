(graft) wenfeiy@la:~/GraftNet$ python main.py --train config/wikimovie_kg.yml
('Current cuda device', 2L)
training ...
('loading document from', 'datasets/wikimovie/10k_train/documents.json')
79728it [00:26, 2981.66it/s]
indexing documents ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 79728/79728 [00:12<00:00, 6568.05it/s]
('loading data from', 'datasets/wikimovie/10k_train/train.json')
10000it [00:07, 1276.67it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:00<00:00, 22001.08it/s]
('avg local entity: ', 49.9008)
('max_local_entity', 50)
preparing data ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:03<00:00, 2671.49it/s]
('loading data from', 'datasets/wikimovie/10k_train/dev.json')
10000it [00:07, 1282.79it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:00<00:00, 25095.92it/s]
('avg local entity: ', 49.8366)
('max_local_entity', 50)
preparing data ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:03<00:00, 2670.57it/s]
('loading data from', 'datasets/wikimovie/10k_train/test.json')
9952it [00:08, 1164.68it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|███████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:00<00:00, 25039.19it/s]
('avg local entity: ', 49.91489147909968)
('max_local_entity', 50)
preparing data ...
100%|████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:03<00:00, 2653.28it/s]
('epoch', 0)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 10.69it/s]
('avg_training_loss', 0.139255639731884)
('max_training_acc', 0.9963999999999997)
('avg_training_acc', 0.4277000000000001)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.53it/s]
('avg_loss', 0.018554872001350305)
('max_acc', 0.9958999999999993)
('avg_acc', 0.954999999999997)
('saving model to', 'repro/wikimovie/best_model_kg')
('epoch', 1)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:12<00:00, 10.37it/s]
('avg_training_loss', 0.013366242241114377)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9590000000000002)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 51.78it/s]
('avg_loss', 0.008753889835221344)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9665999999999969)
('saving model to', 'repro/wikimovie/best_model_kg')
('epoch', 2)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 10.42it/s]
('avg_training_loss', 0.007809168864041567)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9649000000000001)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 51.68it/s]
('avg_loss', 0.006797881317235806)
('max_acc', 0.9958999999999993)
('avg_acc', 0.967799999999997)
('saving model to', 'repro/wikimovie/best_model_kg')
('epoch', 3)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 11.04it/s]
('avg_training_loss', 0.006465740315616131)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9656999999999996)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.11it/s]
('avg_loss', 0.006237271793358787)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9684999999999971)
('saving model to', 'repro/wikimovie/best_model_kg')
('epoch', 4)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 11.00it/s]
('avg_training_loss', 0.00602489862497896)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9670999999999996)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.17it/s]
('avg_loss', 0.005713396710134362)
('max_acc', 0.9958999999999993)
('avg_acc', 0.968299999999997)
('epoch', 5)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 10.94it/s]
('avg_training_loss', 0.005466795723186806)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9666999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 51.73it/s]
('avg_loss', 0.005741566142131773)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9685999999999969)
('saving model to', 'repro/wikimovie/best_model_kg')
('epoch', 6)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 11.00it/s]
('avg_training_loss', 0.005389620787464082)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9691999999999995)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.03it/s]
('avg_loss', 0.00560459912506974)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9677999999999969)
('epoch', 7)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 11.00it/s]
('avg_training_loss', 0.004852384751662612)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9691000000000001)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.08it/s]
('avg_loss', 0.005163100550896615)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9684999999999966)
('epoch', 8)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 10.99it/s]
('avg_training_loss', 0.004741822422482073)
('max_training_acc', 0.9963999999999995)
('avg_training_acc', 0.9685999999999997)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.02it/s]
('avg_loss', 0.0054657320646231255)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9686999999999969)
('saving model to', 'repro/wikimovie/best_model_kg')
('epoch', 9)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:11<00:00, 10.97it/s]
('avg_training_loss', 0.004610050150193274)
('max_training_acc', 0.9963999999999996)
('avg_training_acc', 0.9682999999999997)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 53.00it/s]
('avg_loss', 0.0051747257497570445)
('max_acc', 0.9958999999999993)
('avg_acc', 0.9686999999999972)
('saving model to', 'repro/wikimovie/best_model_kg')
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_kg')
100%|████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [00:14<00:00, 35.10it/s]
('avg_loss', 0.00503942326437577)
('max_acc', 0.9972837022132793)
('avg_acc', 0.967907444668005)
