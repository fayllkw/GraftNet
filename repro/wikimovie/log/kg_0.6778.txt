(graft) wenfeiy@la:~/GraftNet$ python main.py --train config/wikimovie_kg_05.yml
('Current cuda device', 2L)
training ...
('loading document from', 'datasets/wikimovie/10k_train_kb_05/documents.json')
79728it [00:30, 2581.85it/s]
indexing documents ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 79728/79728 [00:14<00:00, 5602.15it/s]
('loading data from', 'datasets/wikimovie/10k_train_kb_05/train.json')
10000it [00:06, 1569.73it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 244)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:00<00:00, 24475.72it/s]
('avg local entity: ', 44.4958)
('max_local_entity', 50)
preparing data ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:03<00:00, 3195.85it/s]
('loading data from', 'datasets/wikimovie/10k_train_kb_05/dev.json')
10000it [00:06, 1634.47it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 244)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:00<00:00, 24032.86it/s]
('avg local entity: ', 44.2193)
('max_local_entity', 50)
preparing data ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:03<00:00, 3229.91it/s]
('loading data from', 'datasets/wikimovie/10k_train_kb_05/test.json')
9952it [00:06, 1608.57it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 244)
building word index ...
converting global to local entity index ...
100%|███████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:00<00:00, 24717.67it/s]
('avg local entity: ', 44.21121382636656)
('max_local_entity', 50)
preparing data ...
100%|████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:03<00:00, 3247.81it/s]
('epoch', 0)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:10<00:00, 11.50it/s]
('avg_training_loss', 0.1168861750215292)
('max_training_acc', 0.7105999999999999)
('avg_training_acc', 0.30689999999999995)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 50.47it/s]
('avg_loss', 0.03695151524059474)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6238000000000002)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 1)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 12.66it/s]
('avg_training_loss', 0.033295144975185396)
('max_training_acc', 0.7106)
('avg_training_acc', 0.6301999999999995)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 50.14it/s]
('avg_loss', 0.02575697611947544)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6481999999999998)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 2)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 13.62it/s]
('avg_training_loss', 0.026567154079675675)
('max_training_acc', 0.7105999999999997)
('avg_training_acc', 0.6456000000000002)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 50.92it/s]
('avg_loss', 0.023337228447431697)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6551999999999997)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 3)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 13.53it/s]
('avg_training_loss', 0.022814105704426765)
('max_training_acc', 0.7106000000000002)
('avg_training_acc', 0.6540000000000002)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 50.29it/s]
('avg_loss', 0.0206960883513093)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6629999999999994)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 4)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 13.34it/s]
('avg_training_loss', 0.02010183223336935)
('max_training_acc', 0.7105999999999997)
('avg_training_acc', 0.6593999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 50.21it/s]
('avg_loss', 0.019236563061247578)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6650999999999999)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 5)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 12.85it/s]
('avg_training_loss', 0.018209740206599236)
('max_training_acc', 0.7106)
('avg_training_acc', 0.6667)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:09<00:00, 50.78it/s]
('avg_loss', 0.0180584308153484)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6696999999999999)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 6)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 12.89it/s]
('avg_training_loss', 0.016568704806268215)
('max_training_acc', 0.7105999999999999)
('avg_training_acc', 0.6688)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:10<00:00, 49.51it/s]
('avg_loss', 0.01832611557270866)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6718999999999999)
('saving model to', 'repro/wikimovie/best_model_kg_05')
('epoch', 7)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:10<00:00, 12.35it/s]
('avg_training_loss', 0.015252924159169196)
('max_training_acc', 0.7106000000000003)
('avg_training_acc', 0.6703999999999998)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:10<00:00, 49.67it/s]
('avg_loss', 0.018482490082853475)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6716999999999995)
('epoch', 8)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:10<00:00, 12.14it/s]
('avg_training_loss', 0.013865078400820494)
('max_training_acc', 0.7105999999999996)
('avg_training_acc', 0.6724000000000001)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:10<00:00, 49.66it/s]
('avg_loss', 0.018158002960146406)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6708999999999996)
('epoch', 9)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:09<00:00, 12.58it/s]
('avg_training_loss', 0.0131173159442842)
('max_training_acc', 0.7105999999999997)
('avg_training_acc', 0.6743000000000003)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [00:10<00:00, 49.81it/s]
('avg_loss', 0.01845562744163908)
('max_acc', 0.7126000000000008)
('avg_acc', 0.6714999999999999)
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_kg_05')
100%|████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [00:13<00:00, 35.57it/s]
('avg_loss', 0.018682060489300788)
('max_acc', 0.7182092555332005)
('avg_acc', 0.6777665995975858)
