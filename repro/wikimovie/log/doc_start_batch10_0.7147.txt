text, start with batch 10

training ...
('loading document from', 'datasets/wikimovie/10k_train/documents.json')
79728it [00:27, 2950.97it/s]
indexing documents ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████| 79728/79728 [00:12<00:00, 6464.53it/s]
('loading data from', 'datasets/wikimovie/10k_train/train.json')
10000it [00:07, 1269.18it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2146.97it/s]
('avg local entity: ', 246.6193)
('max_local_entity', 605)
preparing data ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:03<00:00, 2563.51it/s]
('loading data from', 'datasets/wikimovie/10k_train/dev.json')
10000it [00:08, 1183.91it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2237.54it/s]
('avg local entity: ', 246.0746)
('max_local_entity', 552)
preparing data ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:03<00:00, 2629.47it/s]
('loading data from', 'datasets/wikimovie/10k_train/test.json')
9952it [00:09, 1031.61it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:04<00:00, 2283.74it/s]
('avg local entity: ', 246.8485731511254)
('max_local_entity', 555)
preparing data ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:03<00:00, 2621.44it/s]
('epoch', 0)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:37<00:00,  3.60it/s]
('avg_training_loss', 0.01814551885565743)
('max_training_acc', 0.9802999999999971)
('avg_training_acc', 0.15339999999999987)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:56<00:00,  4.29it/s]
('avg_loss', 0.012179680787958204)
('max_acc', 0.9786999999999977)
('avg_acc', 0.2621999999999997)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 1)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:42<00:00,  3.54it/s]
('avg_training_loss', 0.010044876509811729)
('max_training_acc', 0.9802999999999972)
('avg_training_acc', 0.321)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:45<00:00,  4.73it/s]
('avg_loss', 0.009331979755312204)
('max_acc', 0.9786999999999977)
('avg_acc', 0.44650000000000006)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:29<00:00,  3.72it/s]
('avg_training_loss', 0.00822871631104499)
('max_training_acc', 0.9802999999999971)
('avg_training_acc', 0.4787999999999999)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:44<00:00,  4.77it/s]
('avg_loss', 0.009477997537236662)
('max_acc', 0.9786999999999977)
('avg_acc', 0.45439999999999947)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 3)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:30<00:00,  3.69it/s]
('avg_training_loss', 0.007605047820834443)
('max_training_acc', 0.9802999999999967)
('avg_training_acc', 0.5588000000000006)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:46<00:00,  4.68it/s]
('avg_loss', 0.008005028585437685)
('max_acc', 0.9786999999999977)
('avg_acc', 0.5821000000000006)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 4)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:26<00:00,  3.75it/s]
('avg_training_loss', 0.006692625527270138)
('max_training_acc', 0.9802999999999968)
('avg_training_acc', 0.6298000000000014)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:52<00:00,  4.43it/s]
('avg_loss', 0.007312604900100268)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6060000000000011)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 5)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:39<00:00,  3.58it/s]
('avg_training_loss', 0.005725617215270176)
('max_training_acc', 0.9802999999999968)
('avg_training_acc', 0.6835000000000014)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:58<00:00,  4.21it/s]
('avg_loss', 0.0072040268345735965)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6344)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 6)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:27<00:00,  3.74it/s]
('avg_training_loss', 0.005189462555514183)
('max_training_acc', 0.9802999999999972)
('avg_training_acc', 0.7182999999999995)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:52<00:00,  4.45it/s]
('avg_loss', 0.007016649227240123)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6546000000000004)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 7)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:46<00:00,  3.49it/s]
('avg_training_loss', 0.004948195140808821)
('max_training_acc', 0.9802999999999968)
('avg_training_acc', 0.7439999999999994)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:02<00:00,  4.09it/s]
('avg_loss', 0.007418396328110248)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6619000000000003)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 8)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:39<00:00,  3.58it/s]
('avg_training_loss', 0.004506978132063523)
('max_training_acc', 0.9802999999999976)
('avg_training_acc', 0.7705999999999987)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:49<00:00,  4.55it/s]
('avg_loss', 0.00737050664081471)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6612000000000005)
('epoch', 9)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [04:37<00:00,  3.61it/s]
('avg_training_loss', 0.004492418215493671)
('max_training_acc', 0.9802999999999967)
('avg_training_acc', 0.7806999999999974)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:49<00:00,  4.58it/s]
('avg_loss', 0.00762091405846877)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6716000000000004)
('saving model to', 'repro/wikimovie/best_model_doc')
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_doc')
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [01:55<00:00,  4.30it/s]
('avg_loss', 0.007707823506451982)
('max_acc', 0.9801810865191124)
('avg_acc', 0.6800804828973837)


continue... with batch 80

('Current cuda device', 2L)
training ...
('loading document from', 'datasets/wikimovie/10k_train/documents.json')
79728it [00:32, 2443.37it/s]
indexing documents ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 79728/79728 [00:14<00:00, 5522.92it/s]
('loading data from', 'datasets/wikimovie/10k_train/train.json')
10000it [00:08, 1132.34it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2046.65it/s]
('avg local entity: ', 246.6193)
('max_local_entity', 605)
preparing data ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2363.79it/s]
('loading data from', 'datasets/wikimovie/10k_train/dev.json')
10000it [00:09, 1106.88it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2145.06it/s]
('avg local entity: ', 246.0746)
('max_local_entity', 552)
preparing data ...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2462.84it/s]
('loading data from', 'datasets/wikimovie/10k_train/test.json')
9952it [00:10, 978.96it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 400)
building word index ...
converting global to local entity index ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:04<00:00, 2154.66it/s]
('avg local entity: ', 246.8485731511254)
('max_local_entity', 555)
preparing data ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:04<00:00, 2445.43it/s]
('loading model from', 'repro/wikimovie/best_model_doc')
('epoch', 0)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:30<00:00,  1.68s/it]
('avg_training_loss', 0.003793817633762956)
('max_training_acc', 0.9802999999999988)
('avg_training_acc', 0.8147)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:25<00:00,  3.44it/s]
('avg_loss', 0.008013413268665318)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6764000000000007)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 1)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:34<00:00,  1.72s/it]
('avg_training_loss', 0.0035717513356357815)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8228999999999999)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:30<00:00,  3.31it/s]
('avg_loss', 0.008030221128632548)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6783000000000011)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:29<00:00,  1.67s/it]
('avg_training_loss', 0.003429050617851317)
('max_training_acc', 0.9802999999999991)
('avg_training_acc', 0.8311999999999998)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:34<00:00,  3.24it/s]
('avg_loss', 0.008121812553843484)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6860000000000013)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 3)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:29<00:00,  1.68s/it]
('avg_training_loss', 0.0032867830377072095)
('max_training_acc', 0.9802999999999991)
('avg_training_acc', 0.8394999999999999)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:25<00:00,  3.43it/s]
('avg_loss', 0.008023094479518477)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6904)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 4)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:30<00:00,  1.69s/it]
('avg_training_loss', 0.003163249433040619)
('max_training_acc', 0.9802999999999994)
('avg_training_acc', 0.8479999999999996)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:24<00:00,  3.46it/s]
('avg_loss', 0.008486884624813684)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6916)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 5)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:32<00:00,  1.70s/it]
('avg_training_loss', 0.003053265230730176)
('max_training_acc', 0.9802999999999991)
('avg_training_acc', 0.8519999999999998)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:21<00:00,  3.54it/s]
('avg_loss', 0.008445726202306105)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6928000000000006)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 6)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:33<00:00,  1.71s/it]
('avg_training_loss', 0.002959973064251244)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8585999999999999)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:11<00:00,  3.81it/s]
('avg_loss', 0.008664898702758364)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6954000000000004)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 7)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:37<00:00,  1.74s/it]
('avg_training_loss', 0.002847560305148363)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8676000000000001)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:03<00:00,  4.06it/s]
('avg_loss', 0.009100092148437398)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6975000000000007)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 8)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:32<00:00,  1.70s/it]
('avg_training_loss', 0.0027658939994871616)
('max_training_acc', 0.9802999999999992)
('avg_training_acc', 0.8705999999999998)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:09<00:00,  3.87it/s]
('avg_loss', 0.008852561920633889)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6962000000000009)
('epoch', 9)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:34<00:00,  1.72s/it]
('avg_training_loss', 0.0026832706881687045)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8777000000000004)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:24<00:00,  3.45it/s]
('avg_loss', 0.010485236983862705)
('max_acc', 0.9786999999999977)
('avg_acc', 0.6993000000000003)
('saving model to', 'repro/wikimovie/best_model_doc')
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_doc')
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [02:04<00:00,  3.99it/s]
('avg_loss', 0.010632117694375751)
('max_acc', 0.9801810865191124)
('avg_acc', 0.7107645875251498)


continue... batch 80 lr 0.00001

('loading model from', 'repro/wikimovie/best_model_doc')
('epoch', 0)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:31<00:00,  1.69s/it]
('avg_training_loss', 0.002458595519885421)
('max_training_acc', 0.9802999999999992)
('avg_training_acc', 0.885)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:26<00:00,  3.42it/s]
('avg_loss', 0.010043739384738728)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7056)
('saving model to', 'repro/wikimovie/best_model_doc')
('epoch', 1)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:33<00:00,  1.71s/it]
('avg_training_loss', 0.0023956260439008475)
('max_training_acc', 0.9802999999999995)
('avg_training_acc', 0.8899000000000004)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:32<00:00,  3.28it/s]
('avg_loss', 0.01022525536394096)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7048999999999999)
('epoch', 2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:29<00:00,  1.68s/it]
('avg_training_loss', 0.002380641768686473)
('max_training_acc', 0.9802999999999994)
('avg_training_acc', 0.8895)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:36<00:00,  3.19it/s]
('avg_loss', 0.010329754023492569)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7043999999999999)
('epoch', 3)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:28<00:00,  1.67s/it]
('avg_training_loss', 0.002367170745506883)
('max_training_acc', 0.980299999999999)
('avg_training_acc', 0.8882000000000002)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:27<00:00,  3.38it/s]
('avg_loss', 0.010369075867900392)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7028000000000001)
('epoch', 4)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:36<00:00,  1.73s/it]
('avg_training_loss', 0.0023634378351271154)
('max_training_acc', 0.9802999999999994)
('avg_training_acc', 0.8911999999999995)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:26<00:00,  3.41it/s]
('avg_loss', 0.010421852885832777)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7024000000000002)
('epoch', 5)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:31<00:00,  1.69s/it]
('avg_training_loss', 0.0024187322007492183)
('max_training_acc', 0.9802999999999994)
('avg_training_acc', 0.8880999999999996)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:25<00:00,  3.44it/s]
('avg_loss', 0.010375191996165085)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7024000000000001)
('epoch', 6)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:33<00:00,  1.71s/it]
('avg_training_loss', 0.0023431903319433333)
('max_training_acc', 0.9802999999999991)
('avg_training_acc', 0.8903999999999997)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:13<00:00,  3.73it/s]
('avg_loss', 0.010446993088466115)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7024999999999998)
('epoch', 7)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:34<00:00,  1.71s/it]
('avg_training_loss', 0.002366482749581337)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8923999999999997)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:52<00:00,  4.46it/s]
('avg_loss', 0.010450007218518294)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7029)
('epoch', 8)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:23<00:00,  1.62s/it]
('avg_training_loss', 0.0023364561330527066)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8931999999999997)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:47<00:00,  4.67it/s]
('avg_loss', 0.010517142937693279)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7016)
('epoch', 9)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:24<00:00,  1.64s/it]
('avg_training_loss', 0.002356752899475396)
('max_training_acc', 0.9802999999999993)
('avg_training_acc', 0.8892000000000002)
validating ...
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [01:49<00:00,  4.57it/s]
('avg_loss', 0.010484982530470007)
('max_acc', 0.9786999999999977)
('avg_acc', 0.7023999999999999)
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_doc')
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [01:52<00:00,  4.42it/s]
('avg_loss', 0.010203410081186474)
('max_acc', 0.9801810865191124)
('avg_acc', 0.714688128772635)


