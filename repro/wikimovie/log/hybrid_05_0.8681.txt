50% KB, batch 80

('Current cuda device', 1L)
training ...
('loading document from', 'datasets/wikimovie/10k_train_kb_05/documents.json')
79728it [00:30, 2583.70it/s]
indexing documents ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 79728/79728 [00:14<00:00, 5335.79it/s]
('loading data from', 'datasets/wikimovie/10k_train_kb_05/train.json')
10000it [00:06, 1497.17it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 244)
building word index ...
converting global to local entity index ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:05<00:00, 1969.54it/s]
('avg local entity: ', 282.4566)
('max_local_entity', 615)
preparing data ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:06<00:00, 1571.26it/s]
('loading data from', 'datasets/wikimovie/10k_train_kb_05/dev.json')
10000it [00:06, 1524.78it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 244)
building word index ...
converting global to local entity index ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2113.48it/s]
('avg local entity: ', 281.1151)
('max_local_entity', 597)
preparing data ...
100%|██████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:06<00:00, 1586.58it/s]
('loading data from', 'datasets/wikimovie/10k_train_kb_05/test.json')
9952it [00:06, 1450.10it/s]
('max_relevant_doc: ', 100)
('max_facts: ', 244)
building word index ...
converting global to local entity index ...
100%|████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:04<00:00, 2112.75it/s]
('avg local entity: ', 281.7671824758842)
('max_local_entity', 597)
preparing data ...
100%|████████████████████████████████████████████████████████████████████████████████████████| 9952/9952 [00:06<00:00, 1623.94it/s]
('epoch', 0)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:42<00:00,  1.78s/it]
('avg_training_loss', 0.05375147145241499)
('max_training_acc', 0.9933999999999993)
('avg_training_acc', 0.19260000000000005)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:05<00:00,  3.99it/s]
('avg_loss', 0.012296309921890498)
('max_acc', 0.9929999999999989)
('avg_acc', 0.3868000000000002)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 1)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:41<00:00,  1.77s/it]
('avg_training_loss', 0.011059063840657473)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.4596)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:36<00:00,  3.19it/s]
('avg_loss', 0.009106217632070184)
('max_acc', 0.9929999999999989)
('avg_acc', 0.6228)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 2)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:45<00:00,  1.81s/it]
('avg_training_loss', 0.008508817434310914)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.6529)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:42<00:00,  3.07it/s]
('avg_loss', 0.007266616306267679)
('max_acc', 0.9929999999999989)
('avg_acc', 0.6955999999999992)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 3)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:49<00:00,  1.84s/it]
('avg_training_loss', 0.007133338645100594)
('max_training_acc', 0.9933999999999993)
('avg_training_acc', 0.6969999999999994)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:41<00:00,  3.09it/s]
('avg_loss', 0.006382192642660812)
('max_acc', 0.9929999999999989)
('avg_acc', 0.7127999999999993)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 4)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:39<00:00,  1.76s/it]
('avg_training_loss', 0.00626169827952981)
('max_training_acc', 0.9933999999999991)
('avg_training_acc', 0.7286000000000004)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:39<00:00,  3.13it/s]
('avg_loss', 0.0057240683794952925)
('max_acc', 0.9929999999999989)
('avg_acc', 0.7496999999999999)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 5)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:42<00:00,  1.78s/it]
('avg_training_loss', 0.005520309953019023)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.7659999999999998)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:37<00:00,  3.17it/s]
('avg_loss', 0.005206088750623166)
('max_acc', 0.9929999999999989)
('avg_acc', 0.7880000000000004)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 6)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:42<00:00,  1.78s/it]
('avg_training_loss', 0.005012287946417927)
('max_training_acc', 0.9933999999999993)
('avg_training_acc', 0.7838999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:31<00:00,  3.29it/s]
('avg_loss', 0.004943414012202993)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8023999999999999)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 7)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:42<00:00,  1.78s/it]
('avg_training_loss', 0.004566559184342623)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.8085000000000001)
name: 'wikimovie'
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:30<00:00,  3.33it/s]
('avg_loss', 0.004762990582967177)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8182999999999994)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 8)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:43<00:00,  1.79s/it]
('avg_training_loss', 0.004176604161038995)
('max_training_acc', 0.993399999999999)
('avg_training_acc', 0.8324000000000001)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:22<00:00,  3.52it/s]
('avg_loss', 0.0044920855310047044)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8371999999999992)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 9)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:45<00:00,  1.80s/it]
('avg_training_loss', 0.0038849503677338363)
('max_training_acc', 0.9933999999999991)
('avg_training_acc', 0.8470999999999997)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:22<00:00,  3.50it/s]
('avg_loss', 0.004444527169165667)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8371999999999995)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_hybrid_05')
100%|████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [02:54<00:00,  2.84it/s]
('avg_loss', 0.004496763585947203)
('max_acc', 0.9932595573440632)
('avg_acc', 0.8444668008048283)

continue... 
('epoch', 0)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:38<00:00,  1.75s/it]
('avg_training_loss', 0.003710270330309868)
('max_training_acc', 0.9933999999999991)
('avg_training_acc', 0.8589999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:16<00:00,  3.66it/s]
('avg_loss', 0.004491722482431214)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8460999999999991)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 1)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:44<00:00,  1.80s/it]
('avg_training_loss', 0.003469410385005176)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.8699999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:13<00:00,  3.75it/s]
('avg_loss', 0.0043925931759295055)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8490999999999993)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 2)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:43<00:00,  1.79s/it]
('avg_training_loss', 0.0032685187757015228)
('max_training_acc', 0.9933999999999993)
('avg_training_acc', 0.8834000000000001)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:03<00:00,  4.06it/s]
('avg_loss', 0.004463606678356882)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8538999999999992)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 3)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:37<00:00,  1.74s/it]
('avg_training_loss', 0.0031148619102314115)
('max_training_acc', 0.9933999999999991)
('avg_training_acc', 0.8900999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:38<00:00,  3.16it/s]
('avg_loss', 0.0044884411536040714)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8525999999999992)
('epoch', 4)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:42<00:00,  1.78s/it]
('avg_training_loss', 0.0029394508292898535)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.8924999999999998)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:45<00:00,  3.03it/s]
('avg_loss', 0.0044138889360765465)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8571999999999994)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 5)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:40<00:00,  1.76s/it]
('avg_training_loss', 0.0027651584194973112)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.9017)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:44<00:00,  3.04it/s]
('avg_loss', 0.004668545820604777)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8560999999999994)
('epoch', 6)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:34<00:00,  1.72s/it]
('avg_training_loss', 0.0026577985417097806)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.9038999999999999)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:43<00:00,  3.06it/s]
('avg_loss', 0.004592731044191169)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8578999999999991)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 7)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:36<00:00,  1.73s/it]
('avg_training_loss', 0.002495804917067289)
('max_training_acc', 0.9933999999999993)
('avg_training_acc', 0.9110000000000003)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:40<00:00,  3.11it/s]
('avg_loss', 0.0046902673024887915)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8583999999999984)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 8)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:39<00:00,  1.76s/it]
('avg_training_loss', 0.0023498345967382195)
('max_training_acc', 0.9933999999999991)
('avg_training_acc', 0.9177999999999997)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:36<00:00,  3.20it/s]
('avg_loss', 0.004844976879947353)
('max_acc', 0.9929999999999989)
('avg_acc', 0.859999999999999)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
('epoch', 9)
100%|████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [03:38<00:00,  1.75s/it]
('avg_training_loss', 0.0022609088374301793)
('max_training_acc', 0.9933999999999992)
('avg_training_acc', 0.9220000000000004)
validating ...
100%|████████████████████████████████████████████████████████████████████████████████████████████| 500/500 [02:28<00:00,  3.36it/s]
('avg_loss', 0.004836738827987574)
('max_acc', 0.9929999999999989)
('avg_acc', 0.8624999999999988)
('saving model to', 'repro/wikimovie/best_model_hybrid_05')
evaluating on test
('loading model from ...', 'repro/wikimovie/best_model_hybrid_05')
100%|████████████████████████████████████████████████████████████████████████████████████████████| 497/497 [02:40<00:00,  3.09it/s]
('avg_loss', 0.004925973129198606)
('max_acc', 0.9932595573440632)
('avg_acc', 0.8681086519114679)



